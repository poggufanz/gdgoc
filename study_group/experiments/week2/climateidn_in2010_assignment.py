# -*- coding: utf-8 -*-
"""climateIDN_in2010_assignment.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CcJSVP2-rRvZfq-rYzHzApEwBaYER8zD

## Insialisasi
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.preprocessing import StandardScaler, LabelEncoder
import warnings
warnings.filterwarnings('ignore')

# Setting visualisasi
plt.style.use('default')
sns.set_palette("husl")

"""## Eksplorasi"""

df = pd.read_csv('/content/climate_data.csv')

print(f"Jumlah baris: {len(df)}")
print(f"Jumlah kolom: {len(df.columns)}")

df.head()

df.info()

df.describe()

print("Missing values per kolom:")
print(df.isnull().sum())

"""## Data Cleaning"""

# Cek duplikat data
print(f"Jumlah duplikat: {df.duplicated().sum()}")

# Hapus duplikat jika ada
df = df.drop_duplicates()
print(f"Jumlah baris setelah hapus duplikat: {len(df)}")

# Handle missing values - hapus baris dengan missing values
df_clean = df.dropna()
print(f"Jumlah baris setelah hapus missing values: {len(df_clean)}")

# Menggunakan NumPy untuk operasi pada kolom numerik
tn_array = np.array(df_clean['Tn'])

print("Perhitungan untuk mengecek suhu udara di Indonesia menggunakan NumPy:")
print(f"Mean: {np.mean(tn_array)}")
print(f"Median: {np.median(tn_array)}")
print(f"Std: {np.std(tn_array)}")

# Kesimpulannya pada tahun 2010 suhu indonesia rata-rata ada di 23.3 derajat.
# Tapi, karena mean < median maka dapat disimpulkan bahwa terdapat daerah yang kurang dari 23.
# Kemungkinan terbesar adalah daerah tersebut mempunyai suhu 20 ke bawah.

plt.figure(figsize=(10, 5))
plt.hist(df_clean['Tn'], bins=30)
plt.xlabel('Suhu')
plt.ylabel('Curah Hujan')
plt.title('Suhu Indonesia pada tahun 2010')
plt.show()

plt.figure(figsize=(15, 5))

# Chart 1 - Bukti dugaan sebelumnya
plt.subplot(1, 3, 1) # Gambar ke-1
plt.hist(df_clean['Tn'], bins=100, color='skyblue', edgecolor='black')
plt.axvline(np.mean(df_clean['Tn']), color='red', linestyle='dashed', linewidth=2, label='Mean')
plt.axvline(np.median(df_clean['Tn']), color='green', linestyle='dashed', linewidth=2, label='Median')
plt.title('Distribusi Suhu Minimum (Tn)')
plt.legend()

# Chart 2 - Apakah curah hujan memengaruhi suhu?
plt.subplot(1, 3, 2)
# Kita ambil sample 1000 data aja biar gak berat ngerendernya
sample = df_clean.sample(1000)
plt.scatter(sample['Tn'], sample['RR'], alpha=0.5, color='purple')
plt.title('Hubungan Suhu (Tn) vs Hujan (RR)')
plt.xlabel('Suhu Min')
plt.ylabel('Curah Hujan')

# Chart 3 - Pendeteksi Anomali data.
plt.subplot(1, 3, 3) # Gambar ke-3
sns.boxplot(x=df_clean['Tn'], color='orange')
plt.title('Boxplot Suhu Min (Tn)')

plt.tight_layout()
plt.show()

"""Dari Grafik itu bisa disimpulkan:
1. Grafik pertama itu sesuai dugaan, yaitu akan condong ke kiri karena mean < median yang bisa disimpulkan juga bahwa ada beberapa suhu yang dibawah 20.
2. Grafik kedua menjelaskan bahwa kondisi curah hujan tidak terlalu mempengaruhi karena meskipun curah hujan rendah suhu tetap di perhitungan rata2
3. Grafik ketiga menjelaskan bahwa ada banyak anomali dalam data karena tidak mungkin suhu menyentuh 45-100 derajat bahkan dengan suhu 40 derajat saja manusia sudah tidak bisa.


"""

df_clean = df_clean[(df_clean['Tn'] < 40) & (df_clean['Tn'] > 0)]

df.value_counts()

print({len(df_clean)})

# Pengecekkan kategori suhu
df_clean['Kategori_Suhu'] = pd.cut(
    df_clean['Tn'],
    bins=[-1, 20, 26, 100],  # Batas yg diatur adalah 0-20, 20-26, 26-100
    labels=['Dingin', 'Normal', 'Panas']
)
print(df_clean['Kategori_Suhu'].value_counts())

"""Bisa dilihat bahwa suhu normal 80% dari total hari, menandakan bahwa selama 2010 suhu indonesia terbilang normal."""

from sklearn.preprocessing import StandardScaler, LabelEncoder
import seaborn as sns

# 1 - Mencari hubungan (wwhen yah)
plt.figure(figsize=(10, 8))
cols = ['Tn', 'Tx', 'Tavg', 'RR', 'ss', 'RH_avg']
corr_matrix = df_clean[cols].corr()
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', fmt='.2f')
plt.title('Peta Konspirasi Iklim Indonesia')
plt.show()

# 2 - Mengubah kategori ke angka
# Alasan ngelakuin ini karena mesin gabisa baca Dingin/Panas, jadi kita ubah aja jadi 0, 1, 2.
le = LabelEncoder()
df_clean['Kategori_Angka'] = le.fit_transform(df_clean['Kategori_Suhu'])

print("Perubahan Kategori ke Angka:")
print(df_clean[['Kategori_Suhu', 'Kategori_Angka']].head(10))

# 3 Membuat setara level
# Lalu, disini Kita scaling kolom Tn dan RR biar adil.
scaler = StandardScaler()
df_clean[['Tn_Scaled', 'RR_Scaled']] = scaler.fit_transform(df_clean[['Tn', 'RR']])

# Cek hasil scaling, disini harusnya mean mendekati 0 dan std mendekati 1
print("\nStatistik setelah Scaling (Perhatikan Mean & Std):")
print(f"Mean Tn_Scaled: {df_clean['Tn_Scaled'].mean():.4f}")
print(f"Std Tn_Scaled: {df_clean['Tn_Scaled'].std():.4f}")

# Visualisasi Hasil Scaling
fig, axes = plt.subplots(1, 2, figsize=(12, 5))
sns.histplot(df_clean['Tn'], ax=axes[0], color='blue', kde=True).set_title('Sebelum Scaling (Angka Asli)')
sns.histplot(df_clean['Tn_Scaled'], ax=axes[1], color='green', kde=True).set_title('Sesudah Scaling (Standar)')
plt.show()

"""Disini kita membuat grafik untuk melihat korelasi dan hasil statistik setelah scaling. Tujuan scaling biar mesin bisa baca angkanya."""